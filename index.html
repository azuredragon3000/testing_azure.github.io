<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdMob API Example 2</title>
</head>
<body>
    <h1 id="message">AdMob API Example</h1>
    <button onclick="toggleMessage()">Toggle Message</button>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        function start() {
            document.getElementById('message').innerText = 'Loading AdMob data...';
            // 2. Initialize the JavaScript client library.
            gapi.client.init({
                'apiKey': 'AIzaSyDxvkW93By11leZq3ngoox-DMIuqTXN7Mw',
                'clientId': '989394478630-s5b910djjf197lf04a8h58s9e3eluf1m.apps.googleusercontent.com',
            }).then(function() {
                // Initialization successful
                document.getElementById('message').innerText = 'Initialization successful. Authenticating...';
                var authInstance = gapi.auth2.getAuthInstance();
                if (authInstance.isSignedIn.get()) {
                    // User is already signed in, authentication successful
                    document.getElementById('message').innerText = 'Authentication successful. Making API request...';
                    makeApiRequest();
                } else {
                    // User is not signed in, prompt for authentication
                    authInstance.signIn().then(function() {
                        // Authentication successful
                        document.getElementById('message').innerText = 'Authentication successful. Making API request...';
                        makeApiRequest();
                    }).catch(function(error) {
                        // Error occurred during authentication
                        console.error('Authentication Error:', error);
                        document.getElementById('message').innerText = 'Failed to authenticate. ' + (error.error || 'Unknown error occurred.');
                    });
                }
            }).then(function(response) {
                console.log(response.result);
                document.getElementById('message').innerText = 'AdMob data loaded successfully.'+response.result;
            }).catch(function(error) {
                console.error('Error:', error.message);
                if (error && error.message === 'Init failed') 
                {
                    // Error occurred during initialization
                    document.getElementById('message').innerText = 'Failed to initialize the client library. ' + error.message;
                } 
                else 
                {
                    // Error occurred during API request
                    var errorMessage = error.message || 'Unknown error occurred.';
                    document.getElementById('message').innerText = 'Failed to load AdMob data. ' + errorMessage;
                }
            });
        }

        function toggleMessage() {
            document.getElementById('message').innerText = 'Loading AdMob data...';
            // 1. Load the JavaScript client library.
            gapi.load('client', start);
        }
    </script>
</body>
</html>
